var fs = require('fs');
var path = require('path');
var util = require('util');

exports = function(root_path, if_file, if_dir, if_nopath) {
    root_path = root_path.replace(/\/$/, '');
    if (!path.existsSync(root_path)) {

        if (if_nopath) {
            if_nopath(root_path);
        } else {
            throw new Error(util.format('%s: cannot find path "%s"', __dirname, app_path));
        }
    } else {

        var items = fs.readdirSync(root_path);

        items.forEach(function(item) {
            var root = app_path + '/' + item;
            var s = fs.statSync(root);
            if (s.isDirectory() && if_dir) {
                if_dir(root);
            } else if (s.isFile()){
                if_file(root);
            }
        })
    }

}