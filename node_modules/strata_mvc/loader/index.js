var strata = require('strata');

exports = {
    handlle: function(config, type) {

        var home = require(config.path + '/home');

        return function(env, callback) {

            function _on_params(err, params) {

                if (err && strata.handleError(err, env, callback)) {
                    return;
                }

                if (type == 'format') {
                    var format = env.route.format;
                    if (format == 'json') {
                        callback(200, {}, JSON.stringify(home.info));
                    } else {
                        redirect.forward(env, callback, '/' + config.module.name);
                    }
                } else {
                    callback(200, {}, home.render(params));
                }

            }

            var req = strata.Request(env);
            req.params(_on_params);
        }
        
    }
}