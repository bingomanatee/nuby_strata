var mock = require('../node_modules/strata/lib/mock.js');
var util = require('util');

module.exports = {
    setUp:function (setup_callback) {
        var app_maker = require('./../test_resources/simple_server/app.js');
        module.exports.content = 'simple world';
        module.exports.text_plain = 'text/plain';
        app_maker(function(err, app){
            module.exports.app = app;
          //  console.log('setup done; app = %s', util.inspect(app));
            setup_callback();
        });
    },

    test_simple:function (test) {
        mock.request('/foo_path', module.exports.app, function (err, status, headers, body) {
          //  console.log('err: ', util.inspect(err));
         //   console.log('status', util.inspect(status));
         //   console.log('headers', util.inspect(headers));
        //    console.log('body', util.inspect(body));

            test.equals(body, module.exports.content, 'body should equal ' + module.exports.content);
            test.equals(headers['Content-Type'], module.exports.text_plain,
                'content-type should equal ' + module.exports.text_plain);
            test.done();
        });
    }
}