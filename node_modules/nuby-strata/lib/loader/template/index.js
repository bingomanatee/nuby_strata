var path = require('path');
var proper_path = require('./../../support/proper_path');
var templates = {};

/**
 * note - a template us usually, but not always, a layout.
 * It can serve to format any given bit of material
 *
 * @param template_path
 * @param context
 */

module.exports = function (template_path, context) {
    template_path = context.ROOT + proper_path(template_path);
    if (templates.hasOwnProperty(template_path)) {
        callback(null, templates[template_path]);
    } else {
        path.exists(template_path, function (exists) {
            if (exists) {
                var Template = require(template_path);
                var t =  new Template(template_path);
                templates[template_path] = t;
            } else {
                throw (new Error('cannot load template ' + template_path));
            }
        })
    }
}