var util = require('util');

/**
 * Controller Loader
 */
module.exports = {
    controller_loader:function (type) {
        var loader;
        var loader_path;
        type = type.toLowerCase();
        switch (type) {
            case 'rest':
                loader_path = __dirname +'/REST';
                break;

            case 'default':
                loader_path = __dirname +'/default';
                break;

            default:
                throw new Error(util.format('%s: attempt to get unknown loader %s', __dirname, type));
        }

        loader = require(loader_path);
        return loader;
    },

    init_controller:function (controller_path, load_callback, context, app) {
        var controller = require(controller_path);
        controller.path = controller_path;
        var controller_loader = module.exports.controller_loader(controller.type);
        context.controllers[controller.name] = controller;
        controller_loader.load_actions(controller, load_callback, context, app);
    }
}