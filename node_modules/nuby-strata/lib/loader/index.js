var util = require('util');

module.exports = {
    loader:function (type) {
        var loader;
        var loader_path;
        type = type.toLowerCase();
        switch (type) {
            case 'rest':
                loader_path = __dirname +'/REST';
                break;

            case 'home':
                loader_path = __dirname +'/home';
                break;

            case 'default':
                loader_path = __dirname +'/default';
                break;

            default:
                throw new Error(util.format('%s: attempt to get unknown loader %s', __dirname, type));
        }

        loader = require(loader_path);
        return loader;
    },

    load:function (loader_path, callback, config, app) {
       // console.log('nuby-strata loader::load loading path %s', loader_path);
        var app_info = require(loader_path);
       // console.log('info: %s', util.inspect(app_info, true, 1));

        var loader = module.exports.loader(app_info.type);

      //  console.log('loader::loader type %s loading path ',
       //     app_info.type, loader_path, ' with ', util.inspect(loader, true, 0));

        loader.load(loader_path, callback, config, app, app_info);
    }
}