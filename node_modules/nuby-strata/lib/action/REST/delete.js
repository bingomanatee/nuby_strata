var Base_Action = require('./base');
var _ = require('./../../../node_modules/underscore');
var util = require('util');
var strata = require('./../../../node_modules/strata');

function Delete_Action(config) {
    //  console.log('action on creation: %s', util.inspect(this));
    _.extend(this, config);
    this._init(this);
}

Delete_Action.prototype = _.clone(Base_Action.prototype);

Delete_Action.prototype._on_get = function (err, item, env, on_data_callback) {
    var action = this;

    if (err) {
        return on_data_callback(err);
    }

    action.del(env, item, on_data_callback);

}

Delete_Action.prototype._data_to_env = function (env, data) {
    var out = {};
    out[this.controller.name] = data;
    env._data = out;
}

Delete_Action.prototype.del = function (env, item, on_data_callback) {
    this.controller.model.del(item, on_data_callback);
}

module.exports = {
    Delete_Action:Delete_Action,
    create:function (controller, config, action_path) {

        //  console.log('EA Create:: controller = %s', util.inspect(controller));
        //   console.log('EA Create:: config = %s', util.inspect(config));
        //  console.log('EA Create:: action path = %s', action_path);

        if (!config) {
            config = {type:'default'};
        }

        config.controller = controller;
        config.context = controller.context;
        config.path = action_path;

        var action = new module.exports.Delete_Action(config);

        return action;

    }
}